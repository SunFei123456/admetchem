# 用户认证系统 - 快速开始

## 🎉 功能已完成

ADMETchem 项目的用户注册登录模块已完成开发！

## ✨ 已实现的功能

### 后端 API (FastAPI)
✅ 用户注册接口 (`POST /api/v1/users/register`)
✅ 用户登录接口 (`POST /api/v1/users/login`)  
✅ 获取当前用户信息 (`GET /api/v1/users/me`)
✅ 更新用户信息 (`PUT /api/v1/users/me`)
✅ JWT Token 认证
✅ 密码加密存储（bcrypt）
✅ 邮箱和用户名唯一性验证

### 前端界面 (Vue 3)
✅ 登录页面 (`/login`)
✅ 注册页面 (`/register`)
✅ 个人中心页面 (`/profile`)
✅ 导航栏用户状态显示
✅ 路由守卫（自动拦截需要登录的页面）
✅ Token自动管理
✅ 美观的现代化UI设计

## 🚀 快速启动

### 1. 启动后端

```bash
cd backend

# 激活虚拟环境
.\venv_admet_py311\Scripts\activate

# 安装新依赖（如果还没安装）
pip install python-jose[cryptography]

# 初始化数据库表（首次运行）
python -c "from app.core.database import create_tables; create_tables()"

# 启动服务器
python run.py
```

后端将运行在: http://localhost:8000

### 2. 启动前端

```bash
# 在项目根目录
pnpm run dev
```

前端将运行在: http://localhost:5173

## 📖 使用流程

### 第一步：注册账号

1. 访问 http://localhost:5173
2. 点击导航栏右上角的 **"注册"** 按钮
3. 填写注册信息：
   - 用户名（2-50个字符）
   - 邮箱
   - 密码（至少6位）
   - 确认密码
4. 点击 **"注册"** 按钮
5. 注册成功后自动跳转到登录页

### 第二步：登录

1. 在登录页输入邮箱和密码
2. 点击 **"登录"** 按钮
3. 登录成功后：
   - 自动跳转到首页
   - 导航栏显示用户名和头像

### 第三步：使用个人中心

1. 点击导航栏右上角的用户名
2. 选择 **"个人中心"**
3. 在个人中心可以：
   - 查看账户信息（ID、邮箱、注册时间等）
   - 修改用户名
   - 修改密码
   - 退出登录

## 🎨 界面预览

### 登录页面
- 渐变背景设计
- 密码可见性切换
- 响应式布局
- 平滑过渡动画

### 注册页面
- 密码强度提示（弱/中/强）
- 实时表单验证
- 现代化卡片设计

### 个人中心
- 用户信息展示
- 信息编辑功能
- 安全的密码修改
- 一键退出登录

## 🔐 安全特性

- ✅ 密码使用 bcrypt 加密，不存储明文
- ✅ JWT Token 认证，默认30分钟有效期
- ✅ 自动token过期检测
- ✅ 路由守卫保护需要登录的页面
- ✅ 请求拦截器自动添加认证头

## 📝 API 测试

可以通过 Swagger UI 测试所有API：
http://localhost:8000/docs

## 🗄️ 数据库

用户数据存储在 MySQL 数据库的 `users` 表中：

```sql
-- 查看所有用户
USE admetchem_db;
SELECT id, username, email, is_active, created_at FROM users;
```

## 🛠️ 配置说明

### JWT配置（backend/app/core/config.py）

```python
SECRET_KEY: str = "your-secret-key-here"  # 生产环境请更换
ALGORITHM: str = "HS256"
ACCESS_TOKEN_EXPIRE_MINUTES: int = 30  # Token有效期
```

### 数据库配置

```python
DATABASE_URL: str = "mysql+pymysql://root:123456@localhost/admetchem_db"
```

可以通过 `.env` 文件修改配置。

## 📦 新增的文件

### 后端
- `backend/app/core/auth.py` - JWT认证工具
- `backend/app/models/schemas.py` - 添加了登录、Token等schema
- `backend/app/services/user_service.py` - 更新了用户服务
- `backend/app/api/endpoints/users.py` - 更新了用户接口
- `backend/requirements.txt` - 添加了 python-jose 依赖

### 前端
- `src/api/user.js` - 用户API调用函数
- `src/utils/auth.js` - 认证工具函数
- `src/views/Login.vue` - 登录页面
- `src/views/Register.vue` - 注册页面
- `src/views/Profile.vue` - 个人中心页面
- `src/router/index.js` - 更新了路由配置
- `src/components/Navigation.vue` - 更新了导航组件

## 🐛 故障排除

### 问题1: 后端启动失败，提示找不到 jose 模块

**解决方法:**
```bash
pip install python-jose[cryptography]
```

### 问题2: 前端登录后仍显示未登录

**解决方法:**
1. 清除浏览器缓存
2. 检查浏览器控制台是否有错误
3. 确认后端正常运行

### 问题3: Token过期无法访问

**解决方法:**
- Token默认30分钟过期，需要重新登录

### 问题4: 数据库连接失败

**解决方法:**
1. 确认MySQL服务已启动
2. 检查数据库名称和连接信息
3. 运行创建表的命令

## 📚 详细文档

更多详细信息请查看：
`backend/docs/用户认证系统使用指南.md`

## 🎯 下一步建议

- [ ] 添加邮箱验证功能
- [ ] 实现找回密码
- [ ] 添加用户角色管理
- [ ] 记录登录历史
- [ ] 支持第三方登录（OAuth）
- [ ] 实现Token刷新机制
- [ ] 添加两步验证

## ✅ 测试清单

测试以下场景确保功能正常：

- [ ] 注册新用户
- [ ] 使用错误的邮箱格式注册（应该失败）
- [ ] 使用重复的邮箱注册（应该失败）
- [ ] 登录成功
- [ ] 使用错误密码登录（应该失败）
- [ ] 访问个人中心
- [ ] 修改用户名
- [ ] 修改密码（提供正确的旧密码）
- [ ] 修改密码（提供错误的旧密码，应该失败）
- [ ] 退出登录
- [ ] 未登录时访问个人中心（应该跳转到登录页）

## 🎊 完成！

恭喜！用户认证系统已经完全可用。现在您可以：
1. 注册新账号
2. 登录系统
3. 管理个人信息
4. 开始使用 ADMETchem 的各项功能！

---

**开发团队**: CBDD GROUP  
**项目**: ADMETchem  
**日期**: 2025-10-17

